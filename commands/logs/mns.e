Grouping rows by:   0%|          | 0/17279 [00:00<?, ? column/s]Grouping rows by:   2%|▏         | 299/17279 [00:00<00:05, 2988.58 column/s]Grouping rows by:   3%|▎         | 598/17279 [00:00<00:05, 2983.93 column/s]Grouping rows by:   5%|▌         | 904/17279 [00:00<00:05, 3014.34 column/s]Grouping rows by:   7%|▋         | 1211/17279 [00:00<00:05, 3034.49 column/s]Grouping rows by:   9%|▉         | 1518/17279 [00:00<00:05, 3046.31 column/s]Grouping rows by:  11%|█         | 1827/17279 [00:00<00:05, 3059.67 column/s]Grouping rows by:  12%|█▏        | 2133/17279 [00:00<00:04, 3044.45 column/s]Grouping rows by:  14%|█▍        | 2441/17279 [00:00<00:04, 3052.74 column/s]Grouping rows by:  16%|█▌        | 2750/17279 [00:00<00:04, 3064.23 column/s]Grouping rows by:  18%|█▊        | 3058/17279 [00:01<00:04, 3067.42 column/s]Grouping rows by:  19%|█▉        | 3367/17279 [00:01<00:04, 3073.99 column/s]Grouping rows by:  21%|██▏       | 3676/17279 [00:01<00:04, 3075.71 column/s]Grouping rows by:  23%|██▎       | 3984/17279 [00:01<00:05, 2333.41 column/s]Grouping rows by:  25%|██▍       | 4291/17279 [00:01<00:05, 2514.86 column/s]Grouping rows by:  27%|██▋       | 4597/17279 [00:01<00:04, 2656.65 column/s]Grouping rows by:  28%|██▊       | 4905/17279 [00:01<00:04, 2768.06 column/s]Grouping rows by:  30%|███       | 5214/17279 [00:01<00:04, 2856.13 column/s]Grouping rows by:  32%|███▏      | 5521/17279 [00:01<00:04, 2914.55 column/s]Grouping rows by:  34%|███▎      | 5830/17279 [00:02<00:03, 2964.34 column/s]Grouping rows by:  36%|███▌      | 6138/17279 [00:02<00:03, 2995.19 column/s]Grouping rows by:  37%|███▋      | 6446/17279 [00:02<00:03, 3018.35 column/s]Grouping rows by:  39%|███▉      | 6755/17279 [00:02<00:03, 3038.54 column/s]Grouping rows by:  41%|████      | 7062/17279 [00:02<00:03, 3047.03 column/s]Grouping rows by:  43%|████▎     | 7370/17279 [00:02<00:03, 3054.70 column/s]Grouping rows by:  44%|████▍     | 7680/17279 [00:02<00:03, 3065.43 column/s]Grouping rows by:  46%|████▌     | 7989/17279 [00:02<00:03, 3070.06 column/s]Grouping rows by:  48%|████▊     | 8297/17279 [00:02<00:02, 3068.47 column/s]Grouping rows by:  50%|████▉     | 8605/17279 [00:02<00:02, 3066.93 column/s]Grouping rows by:  52%|█████▏    | 8914/17279 [00:03<00:02, 3071.92 column/s]Grouping rows by:  53%|█████▎    | 9224/17279 [00:03<00:02, 3078.01 column/s]Grouping rows by:  55%|█████▌    | 9532/17279 [00:03<00:02, 3077.72 column/s]Grouping rows by:  57%|█████▋    | 9840/17279 [00:03<00:02, 3077.70 column/s]Grouping rows by:  59%|█████▊    | 10149/17279 [00:03<00:02, 3080.92 column/s]Grouping rows by:  61%|██████    | 10458/17279 [00:03<00:03, 2263.78 column/s]Grouping rows by:  62%|██████▏   | 10766/17279 [00:03<00:02, 2457.65 column/s]Grouping rows by:  64%|██████▍   | 11073/17279 [00:03<00:02, 2613.46 column/s]Grouping rows by:  66%|██████▌   | 11382/17279 [00:03<00:02, 2739.38 column/s]Grouping rows by:  68%|██████▊   | 11692/17279 [00:04<00:01, 2836.42 column/s]Grouping rows by:  69%|██████▉   | 12000/17279 [00:04<00:01, 2903.94 column/s]Grouping rows by:  71%|███████   | 12309/17279 [00:04<00:01, 2956.95 column/s]Grouping rows by:  73%|███████▎  | 12617/17279 [00:04<00:01, 2992.57 column/s]Grouping rows by:  75%|███████▍  | 12925/17279 [00:04<00:01, 3016.08 column/s]Grouping rows by:  77%|███████▋  | 13234/17279 [00:04<00:01, 3036.24 column/s]Grouping rows by:  78%|███████▊  | 13542/17279 [00:04<00:01, 3046.51 column/s]Grouping rows by:  80%|████████  | 13850/17279 [00:04<00:01, 3053.54 column/s]Grouping rows by:  82%|████████▏ | 14159/17279 [00:04<00:01, 3063.12 column/s]Grouping rows by:  84%|████████▎ | 14467/17279 [00:04<00:00, 3067.29 column/s]Grouping rows by:  86%|████████▌ | 14776/17279 [00:05<00:00, 3071.46 column/s]Grouping rows by:  87%|████████▋ | 15084/17279 [00:05<00:00, 3072.23 column/s]Grouping rows by:  89%|████████▉ | 15392/17279 [00:05<00:00, 3073.39 column/s]Grouping rows by:  91%|█████████ | 15702/17279 [00:05<00:00, 3078.66 column/s]Grouping rows by:  93%|█████████▎| 16011/17279 [00:05<00:00, 3063.61 column/s]Grouping rows by:  94%|█████████▍| 16318/17279 [00:05<00:00, 3060.37 column/s]Grouping rows by:  96%|█████████▌| 16627/17279 [00:05<00:00, 3067.03 column/s]Grouping rows by:  98%|█████████▊| 16934/17279 [00:05<00:00, 3053.92 column/s]Grouping rows by: 100%|█████████▉| 17244/17279 [00:05<00:00, 3064.70 column/s]Grouping rows by: 100%|██████████| 17279/17279 [00:05<00:00, 2951.66 column/s]
  0%|          | 0/25 [00:00<?, ?it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 0/72903 [00:00<?, ?it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 8/72903 [00:02<6:03:35,  3.34it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 12/72903 [00:04<8:27:48,  2.39it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 16/72903 [00:07<9:43:12,  2.08it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 20/72903 [00:09<10:27:32,  1.94it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 24/72903 [00:11<10:55:18,  1.85it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 28/72903 [00:14<11:13:28,  1.80it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 32/72903 [00:16<11:25:52,  1.77it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 36/72903 [00:18<11:33:43,  1.75it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 40/72903 [00:21<11:39:35,  1.74it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 44/72903 [00:23<11:43:25,  1.73it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 48/72903 [00:25<11:47:34,  1.72it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 52/72903 [00:28<11:49:13,  1.71it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 56/72903 [00:30<11:50:05,  1.71it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 60/72903 [00:32<11:50:36,  1.71it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 64/72903 [00:35<11:50:56,  1.71it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 68/72903 [00:37<11:53:19,  1.70it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 72/72903 [00:39<11:53:00,  1.70it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 76/72903 [00:42<11:55:25,  1.70it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 80/72903 [00:44<11:54:16,  1.70it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 84/72903 [00:47<12:05:45,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 88/72903 [00:49<12:13:54,  1.65it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 92/72903 [00:52<12:20:43,  1.64it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 96/72903 [00:54<12:23:46,  1.63it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 100/72903 [00:57<12:26:41,  1.63it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 104/72903 [00:59<12:29:16,  1.62it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 108/72903 [01:02<12:30:42,  1.62it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 112/72903 [01:04<12:29:20,  1.62it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 116/72903 [01:06<12:21:02,  1.64it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 120/72903 [01:09<12:15:41,  1.65it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 124/72903 [01:11<12:10:52,  1.66it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 128/72903 [01:14<12:08:08,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 132/72903 [01:16<12:06:07,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 136/72903 [01:18<12:05:12,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 140/72903 [01:21<12:04:41,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 144/72903 [01:23<12:06:09,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 148/72903 [01:25<12:04:43,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 152/72903 [01:28<12:05:44,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 156/72903 [01:30<12:04:46,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 160/72903 [01:33<12:04:58,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 164/72903 [01:35<12:03:57,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 168/72903 [01:37<12:03:55,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 172/72903 [01:40<12:04:06,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 176/72903 [01:42<12:04:18,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 180/72903 [01:45<12:03:53,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 184/72903 [01:47<12:03:31,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 188/72903 [01:49<12:02:52,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 192/72903 [01:52<12:02:22,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 196/72903 [01:54<12:01:55,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 200/72903 [01:57<12:02:32,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 204/72903 [01:59<12:02:19,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 208/72903 [02:01<12:02:14,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 212/72903 [02:04<12:01:52,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 216/72903 [02:06<12:01:27,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 220/72903 [02:08<12:01:53,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 224/72903 [02:11<12:02:32,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 228/72903 [02:13<12:10:00,  1.66it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 232/72903 [02:16<12:15:47,  1.65it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 236/72903 [02:18<12:12:42,  1.65it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 240/72903 [02:21<12:05:22,  1.67it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 244/72903 [02:23<12:00:41,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 248/72903 [02:25<11:56:59,  1.69it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 252/72903 [02:28<11:54:21,  1.70it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 256/72903 [02:30<11:53:35,  1.70it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 260/72903 [02:32<11:55:39,  1.69it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 264/72903 [02:35<11:57:02,  1.69it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 268/72903 [02:37<11:58:22,  1.69it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 272/72903 [02:39<11:59:07,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 276/72903 [02:42<12:00:51,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 280/72903 [02:44<12:01:07,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 284/72903 [02:47<12:01:03,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 288/72903 [02:49<12:01:13,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 292/72903 [02:51<12:01:03,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 296/72903 [02:54<12:01:08,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 300/72903 [02:56<12:01:05,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 304/72903 [02:58<12:01:07,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 308/72903 [03:01<12:01:19,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 312/72903 [03:03<12:01:21,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 316/72903 [03:06<12:01:02,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 320/72903 [03:08<12:01:33,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 324/72903 [03:10<12:01:05,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 328/72903 [03:13<12:00:38,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 332/72903 [03:15<12:00:37,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 336/72903 [03:18<12:00:18,  1.68it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 340/72903 [03:20<12:05:21,  1.67it/s]                                                                                                                                                      0%|          | 0/25 [04:11<?, ?it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 340/72903 [03:20<12:05:21,  1.67it/s]                                                                                                                                                      0%|          | 0/25 [04:11<?, ?it/s][Trial 4] Projecting initial data into diffusion space:   0%|          | 340/72903 [03:20<12:05:21,  1.67it/s]  0%|          | 0/25 [04:11<?, ?it/s]
Traceback (most recent call last):
  File "/home/ec2-user/SageMaker/projects/mns-dev/niche-space/commands/run_mns.py", line 51, in <module>
    mns.fit(X, y1, y2) #, distance_matrix=distance_matrix)
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/nichespace/manifold.py", line 883, in fit
    self.study_ = self.tune(
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/nichespace/manifold.py", line 749, in tune
    study.optimize(
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/nichespace/manifold.py", line 692, in _objective
    dmap_X = self._parallel_transform(X.values, model, progressbar_message=f"[Trial {trial.number}] Projecting initial data into diffusion space")
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/nichespace/manifold.py", line 1007, in _parallel_transform
    output = joblib.Parallel(n_jobs=self.n_jobs, **self.parallel_kws)(
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/joblib/parallel.py", line 2007, in __call__
    return output if self.return_generator else list(output)
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/joblib/parallel.py", line 1650, in _get_outputs
    yield from self._retrieve()
  File "/home/ec2-user/SageMaker/environments/mns/lib/python3.9/site-packages/joblib/parallel.py", line 1762, in _retrieve
    time.sleep(0.01)
KeyboardInterrupt
Command terminated by signal 2
	Command being timed: "python run_mns.py"
	User time (seconds): 1065.89
	System time (seconds): 434.87
	Percent of CPU this job got: 505%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 4:56.63
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 36088892
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 1909
	Minor (reclaiming a frame) page faults: 1405650
	Voluntary context switches: 39374
	Involuntary context switches: 81478
	Swaps: 0
	File system inputs: 3974456
	File system outputs: 160
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
